{% extends "layout.html" %}

{% block content %}
<div id="commentBody">
    <div id="commentForm">    
        <h1>Laissez-nous un mot</h1>
        {% if commentError == true %}
          <p style="color:red;">{{ commentPayload }}</p>
          <form method="post" action="addComment">
              <label>Commentaire :</label><br/>
              <textarea name="content" id="comment" placeholder="Votre message pour les mariés" rows="4" cols="60" required>{{ defaultContent }}</textarea>
              <input type="text" name="author" placeholder="Votre nom" value="{{ defaultAuthor }}" required/>
              <input type="submit" value="Envoyer" />
          </form>
          <p><em>Une fois envoyé, votre commentaire sera ajouté à la liste que vous pouvez trouver ci-dessous</em>></p>
        {% else %}
          <p style="color:green;">Merci de votre participation.</p>
        {% endif %}
    </div>
    <div>
        <h1>Ce dont vous nous avez fait part</h1>
        <section id="comments">
        {% for c in comments %}
          <div class="singleComment">
            <p><span class="commentAuthor">{{ c.author }}</span> <span class="commentDate">{{ c.comment_date }}</span></p>
            <p><span class="commentContent">{{ c.content }}</span></ps>
            <form method="post" action="/likeComment">
              <input type="hidden" name="id" value="{{ c.id }}" />
              <button type="submit" class="commentLike" name="like" value="{{ c.likes }}"><img src="/icons/like_dark.png" alt="likeIcon" />{{ c.likes }}</button>
            </form>
          </div>
        {% else %}
          <p>Personne n'a encore laissé de commentaire...</p>
        {% endfor %}
        </section>
    </div>
</div>

<script>
    const commentLikes = document.getElementsByClassName("commentLike");
    
    let displayLikeLight = function() {
      this.children[0].setAttribute("src", "/icons/like_light.png");
    }

    let displayLikeDark = function() {
      this.children[0].setAttribute("src", "/icons/like_dark.png");
    }
    
    for (var i=0; i < commentLikes.length; i++) {
      commentLikes[i].addEventListener('mouseenter', displayLikeLight);
    }

    for (var i=0; i < commentLikes.length; i++) {
      commentLikes[i].addEventListener('mouseleave', displayLikeDark);
    }
</script>

{% endblock %}